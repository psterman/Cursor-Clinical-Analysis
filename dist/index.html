<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cursor Audit Pro - Wasm 版本</title>
  <script type="module" crossorigin src="/assets/index-QHVPu4Fd.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/sql.js-Bh3UTgnK.js">
  <link rel="modulepreload" crossorigin href="/assets/chart.js-Dss0t15A.js">
  <link rel="modulepreload" crossorigin href="/assets/html2canvas-BAqrGSTL.js">
  <link rel="stylesheet" crossorigin href="/assets/index-CFFr6Wba.css">
</head>
<body>
  <div class="container">
    <!-- 顶部导航 -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">🔍</span>
          <span class="logo-text">Cursor Audit Pro</span>
        </div>
        <div class="header-actions">
          <button id="uploadBtn" class="btn btn-primary">
            <span class="btn-icon">📁</span>
            <span>上传数据库文件夹</span>
          </button>
          <input type="file" id="folderInput" webkitdirectory directory multiple hidden>
          <input type="file" id="fileInput" accept=".vscdb,.db,.sqlite,.sqlite3" multiple hidden>
          <button id="exportBtn" class="btn btn-secondary">
            <span class="btn-icon">📊</span>
            <span>保存分析报告</span>
          </button>
        </div>
      </div>
    </header>

    <!-- 上传区域 -->
    <div id="uploadSection" class="upload-section">
      <div class="upload-zone">
        <div class="upload-icon">📂</div>
        <h2 class="upload-title">上传 Cursor 数据库文件夹</h2>
        <p class="upload-desc">
          选择您的 Cursor workspaceStorage 目录（位于 %AppData%/Cursor/User/workspaceStorage）
        </p>
        <div class="upload-buttons">
          <button id="selectFolderBtn" class="btn btn-large btn-primary">
            选择文件夹（批量处理）
          </button>
          <button id="selectFileBtn" class="btn btn-large btn-secondary">
            选择单个文件
          </button>
        </div>
        <div class="upload-tips">
          <p class="upload-tip">
            <strong>💡 提示：</strong>只支持 .vscdb 数据库文件，不支持图片、文档等其他文件
          </p>
          <p class="upload-note">
            所有解析都在本地完成，数据不会上传到任何服务器
          </p>
        </div>
        <p id="uploadError" class="upload-error hidden"></p>
      </div>
    </div>

    <!-- 加载状态 -->
    <div id="loadingSection" class="loading-section hidden">
      <div class="loading-spinner"></div>
      <p class="loading-text">正在解析数据库...</p>
      <p id="loadingProgress" class="loading-progress">已处理 0 个文件</p>
    </div>

    <!-- 分析结果 -->
    <div id="dashboardSection" class="dashboard-section hidden">
      <!-- 统计卡片 -->
      <div class="stats-grid" id="exportArea">
        <div class="stat-card">
          <div class="stat-icon stat-icon-blue">💬</div>
          <div class="stat-content">
            <p class="stat-label">总对话次数</p>
            <p class="stat-value" id="totalConversations">0</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-green">⚡</div>
          <div class="stat-content">
            <p class="stat-label">AI 产出代码</p>
            <p class="stat-value" id="totalCodeChars">0</p>
            <p class="stat-unit">字符</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-orange">👤</div>
          <div class="stat-content">
            <p class="stat-label">用户消息</p>
            <p class="stat-value" id="userMessages">0</p>
          </div>
        </div>
      </div>

      <!-- 统计卡片扩展 -->
      <div class="stats-grid" id="statsGridExtra">
        <div class="stat-card">
          <div class="stat-icon stat-icon-purple">请</div>
          <div class="stat-content">
            <p class="stat-label">使用"请"字次数</p>
            <p class="stat-value" id="qingCount">0</p>
            <p class="stat-unit">次</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon-red">不</div>
          <div class="stat-content">
            <p class="stat-label">使用"不"字次数</p>
            <p class="stat-value" id="buCount">0</p>
            <p class="stat-unit">次</p>
          </div>
        </div>
      </div>

      <!-- 用户提问最多汉字词组 -->
      <div class="chart-card">
        <h3 class="chart-title">📝 用户提问最多汉字词组 Top 10</h3>
        <div class="prompts-list" id="topChineseWordsList">
          <div class="prompt-item">
            <span class="prompt-text">暂无数据</span>
            <span class="prompt-count">0 次</span>
          </div>
        </div>
      </div>

      <!-- 对话列表 -->
      <div class="chat-list-section">
        <div class="chat-list-header">
          <h3 class="chat-list-title">对话记录</h3>
          <div class="chat-list-controls">
            <input type="text" id="searchInput" class="search-input" placeholder="搜索对话...">
          </div>
        </div>
        <div class="chat-list" id="chatList">
          <!-- 对话项将通过 JavaScript 动态生成 -->
        </div>
      </div>
    </div>
  </div>

</body>
</html>
